{"version":3,"file":"index.js","sources":["../src/components/VideoPlayer.tsx","../src/utils.ts","../src/components/AssetPreview.tsx","../src/components/WidgetInput.tsx","../src/components/SecretsConfigView.tsx","../src/components/CloudinaryInput.tsx","../src/components/AssetDiff.tsx","../src/schema/cloudinaryAsset.ts","../src/schema/cloudinaryAssetDerived.ts","../src/components/asset-source/Icon.tsx","../src/components/asset-source/CloudinaryAssetSource.tsx","../src/schema/cloudinaryAssetContext.ts","../src/schema/cloudinaryAssetContextCustom.ts","../src/components/AssetListFunctions.tsx","../src/index.ts"],"sourcesContent":["import React, {CSSProperties} from 'react'\n\ntype PlayerKind = 'player' | 'diff'\n\nexport type VideoPlayerProps = {\n  src: string\n  // eslint-disable-next-line react/no-unused-prop-types\n  kind: PlayerKind\n}\n\nexport default function VideoPlayer(props: VideoPlayerProps) {\n  const {src} = props\n\n  const style: CSSProperties = {\n    width: '100%',\n    height: 'auto',\n  }\n\n  return (\n    <video controls style={style}>\n      <source src={src} type=\"video/mp4\" />\n    </video>\n  )\n}\n","/* eslint-disable camelcase,@typescript-eslint/explicit-module-boundary-types */\nimport {\n  CloudinaryAsset,\n  CloudinaryAssetResponse,\n  CloudinaryMediaLibrary,\n  InsertHandlerParams,\n} from './types'\n\nconst widgetSrc = 'https://media-library.cloudinary.com/global/all.js'\n\nexport function assetUrl(asset: Partial<Pick<CloudinaryAsset, 'url' | 'secure_url' | 'derived'>>) {\n  if (asset.derived && asset.derived.length > 0) {\n    const [derived] = asset.derived\n    if (derived.secure_url) {\n      return derived.secure_url\n    }\n    return derived.url\n  }\n  if (asset.secure_url) {\n    return asset.secure_url\n  }\n  return asset.url\n}\n\nexport const openMediaSelector = (\n  cloudName: string,\n  apiKey: string,\n  multiple: boolean,\n  insertHandler: (params: InsertHandlerParams) => void,\n  selectedAsset?: CloudinaryAsset\n) => {\n  loadJS(widgetSrc, () => {\n    const options: Record<string, any> = {\n      cloud_name: cloudName,\n      api_key: apiKey,\n      insert_caption: 'Select',\n      multiple,\n    }\n\n    if (selectedAsset) {\n      options.asset = {\n        public_id: selectedAsset.public_id,\n        type: selectedAsset.type,\n        resource_type: selectedAsset.resource_type,\n      }\n    }\n\n    window.cloudinary.openMediaLibrary(options, {insertHandler})\n  })\n}\n\nexport const createMediaLibrary = ({\n  cloudName,\n  apiKey,\n  inlineContainer,\n  libraryCreated,\n  insertHandler,\n}: {\n  cloudName: string\n  apiKey: string\n  inlineContainer: string\n  libraryCreated: (library: CloudinaryMediaLibrary) => void\n  insertHandler: (params: InsertHandlerParams) => void\n}) => {\n  loadJS(widgetSrc, () => {\n    const options: Record<string, any> = {\n      cloud_name: cloudName,\n      api_key: apiKey,\n      insert_caption: 'Select',\n      inline_container: inlineContainer,\n      remove_header: true,\n    }\n\n    libraryCreated(window.cloudinary.createMediaLibrary(options, {insertHandler}))\n  })\n}\n\nexport function loadJS(url: string, callback: () => void) {\n  const existingScript = document.getElementById('damWidget')\n  if (!existingScript) {\n    const script = document.createElement('script')\n    script.src = url\n    script.id = 'damWidget'\n    document.body.appendChild(script)\n    script.onload = () => {\n      if (callback) {\n        return callback()\n      }\n      return true\n    }\n  }\n  if (existingScript && callback) {\n    return callback()\n  }\n  return true\n}\n\nexport function encodeSourceId(asset: CloudinaryAssetResponse): string {\n  const {resource_type, public_id, type} = asset\n  return btoa(JSON.stringify({public_id, resource_type, type})) // Sort keys alphabetically!\n}\n\nexport function encodeFilename(asset: CloudinaryAssetResponse) {\n  return `${asset.public_id.split('/').slice(-1)[0]}.${asset.format}`\n}\n\nexport function decodeSourceId(sourceId: string): CloudinaryAssetResponse | undefined {\n  let sourceIdDecoded: any\n  try {\n    sourceIdDecoded = JSON.parse(atob(sourceId))\n  } catch (err) {\n    // Do nothing\n  }\n  return sourceIdDecoded\n}\n","import React from 'react'\nimport VideoPlayer from './VideoPlayer'\nimport {assetUrl} from '../utils'\nimport {Flex} from '@sanity/ui'\nimport {CloudinaryAsset} from '../types'\n\ninterface ComponentProps {\n  layout?: 'default' | 'block'\n  value: CloudinaryAsset | undefined\n}\n\nconst AssetPreview = ({value, layout}: ComponentProps) => {\n  const url = value && assetUrl(value)\n  if (!value || !url) {\n    return null\n  }\n\n  switch (value.resource_type) {\n    case 'video':\n      return (\n        <Flex\n          align=\"center\"\n          style={{\n            maxWidth: layout === 'default' ? '80px' : '100%',\n          }}\n        >\n          <VideoPlayer src={url} kind=\"player\" />\n        </Flex>\n      )\n    default:\n      return (\n        <Flex align=\"center\">\n          <img\n            alt=\"preview\"\n            src={url}\n            style={{\n              maxWidth: layout === 'default' ? '80px' : '100%',\n              height: 'auto',\n            }}\n          />\n        </Flex>\n      )\n  }\n}\n\nexport default AssetPreview\n","import React, {useCallback} from 'react'\nimport {ObjectInputProps, PatchEvent, unset} from 'sanity'\nimport {Button, Flex, Grid, Stack} from '@sanity/ui'\nimport {PlugIcon} from '@sanity/icons'\nimport styled from 'styled-components'\nimport AssetPreview from './AssetPreview'\nimport {CloudinaryAsset} from '../types'\n\nconst SetupButtonContainer = styled.div`\n  position: relative;\n  display: block;\n  font-size: 0.8em;\n  transform: translate(0%, -10%);\n`\n\ntype WidgetInputProps = ObjectInputProps & {openMediaSelector: () => void; onSetup: () => void}\n\nconst WidgetInput = (props: WidgetInputProps) => {\n  const {onChange, readOnly, value, openMediaSelector} = props\n\n  const removeValue = useCallback(() => {\n    onChange(PatchEvent.from([unset()]))\n  }, [onChange])\n\n  return (\n    <Stack>\n      <SetupButtonContainer>\n        <Flex flex={1} justify=\"flex-end\">\n          <Button\n            color=\"primary\"\n            icon={PlugIcon}\n            mode=\"bleed\"\n            title=\"Configure\"\n            onClick={props.onSetup}\n            tabIndex={1}\n          />\n        </Flex>\n      </SetupButtonContainer>\n\n      <Flex style={{textAlign: 'center', width: '100%'}} marginBottom={2}>\n        <AssetPreview value={value as CloudinaryAsset} />\n      </Flex>\n\n      <Grid gap={1} style={{gridTemplateColumns: 'repeat(auto-fit, minmax(100px, 1fr))'}}>\n        <Button\n          disabled={readOnly}\n          mode=\"ghost\"\n          title=\"Select an asset\"\n          tone=\"default\"\n          onClick={openMediaSelector}\n          text=\"Selectâ€¦\"\n        />\n        <Button\n          disabled={readOnly || !value}\n          tone=\"critical\"\n          mode=\"ghost\"\n          title=\"Remove asset\"\n          text=\"Remove\"\n          onClick={removeValue}\n        />\n      </Grid>\n    </Stack>\n  )\n}\n\nexport default WidgetInput\n","import React from 'react'\nimport {SettingsView} from '@sanity/studio-secrets'\n\nexport type Secrets = {\n  cloudName: string\n  apiKey: string\n}\n\nconst pluginConfigKeys = [\n  {\n    key: 'cloudName',\n    title: 'Cloud name',\n    description: '',\n  },\n  {\n    key: 'apiKey',\n    title: 'API key',\n    description: '',\n  },\n]\n\nexport const namespace = 'cloudinary'\n\ntype Props = {\n  onClose: () => void\n}\n\nconst SecretsConfigView = (props: Props) => {\n  return (\n    <SettingsView\n      title=\"Cloudinary config\"\n      namespace={namespace}\n      keys={pluginConfigKeys}\n      onClose={props.onClose}\n    />\n  )\n}\n\nexport default SecretsConfigView\n","import React, {useCallback, useState} from 'react'\nimport WidgetInput from './WidgetInput'\nimport {nanoid} from 'nanoid'\nimport {ObjectInputProps, PatchEvent, set} from 'sanity'\nimport {CloudinaryAsset} from '../types'\nimport {useSecrets} from '@sanity/studio-secrets'\nimport {InsertHandlerParams} from '../types'\nimport {openMediaSelector} from '../utils'\nimport SecretsConfigView, {namespace, Secrets} from './SecretsConfigView'\n\nconst CloudinaryInput = (props: ObjectInputProps) => {\n  const [showSettings, setShowSettings] = useState(false)\n  const {secrets} = useSecrets<Secrets>(namespace)\n  const {onChange, schemaType: type} = props\n  const value = (props.value as CloudinaryAsset) || undefined\n\n  const handleSelect = useCallback(\n    (payload: InsertHandlerParams) => {\n      const [asset] = payload.assets\n      if (!asset) {\n        return\n      }\n\n      onChange(\n        PatchEvent.from([\n          set(\n            Object.assign(\n              {\n                _type: type.name,\n                _version: 1,\n                ...(value?._key ? {_key: value._key} : {_key: nanoid()}),\n              },\n              asset\n            )\n          ),\n        ])\n      )\n    },\n    [onChange, type, value?._key]\n  )\n\n  const action = secrets\n    ? () =>\n        openMediaSelector(\n          secrets.cloudName,\n          secrets.apiKey,\n          false, // single selection\n          handleSelect,\n          value\n        )\n    : () => setShowSettings(true)\n\n  return (\n    <>\n      {showSettings && <SecretsConfigView onClose={() => setShowSettings(false)} />}\n      <WidgetInput onSetup={() => setShowSettings(true)} openMediaSelector={action} {...props} />\n    </>\n  )\n}\n\nexport default CloudinaryInput\n","import React from 'react'\nimport {DiffFromTo} from 'sanity'\nimport VideoPlayer from './VideoPlayer'\nimport {assetUrl} from '../utils'\nimport {CloudinaryAsset} from '../types'\n\ntype Props = {\n  value: CloudinaryAsset | undefined\n}\n\nconst CloudinaryDiffPreview = ({value}: Props) => {\n  if (!value) {\n    return null\n  }\n\n  const url = assetUrl(value)\n\n  if (value.resource_type === 'video' && url) {\n    return (\n      <section\n        style={{\n          display: 'flex',\n          flexWrap: 'wrap',\n          justifyContent: 'space-between',\n        }}\n      >\n        <VideoPlayer src={url} kind=\"diff\" />\n      </section>\n    )\n  }\n\n  return <img alt=\"preview\" src={url} style={{maxWidth: '100%', height: 'auto'}} />\n}\n\ntype DiffProps = {\n  diff: any\n  schemaType: any\n}\n\nconst AssetDiff = ({diff, schemaType}: DiffProps) => {\n  return <DiffFromTo diff={diff} schemaType={schemaType} previewComponent={CloudinaryDiffPreview} />\n}\n\nexport default AssetDiff\n","/* eslint-disable */\nimport CloudinaryInput from '../components/CloudinaryInput'\nimport AssetDiff from '../components/AssetDiff'\nimport AssetPreview from '../components/AssetPreview'\nimport {defineType} from 'sanity'\n\nexport const cloudinaryAssetSchema = defineType({\n  type: 'object',\n  name: 'cloudinary.asset',\n  fields: [\n    {\n      type: 'string',\n      name: 'public_id',\n    },\n    {\n      type: 'string',\n      name: 'resource_type',\n      // \"image\", \"?\"\n    },\n    {\n      type: 'string',\n      name: 'type',\n      // \"upload\", \"?\"\n    },\n    {\n      type: 'string',\n      name: 'format',\n      // \"jpg\"\n    },\n    {\n      type: 'number',\n      name: 'version',\n    },\n    {\n      type: 'url',\n      name: 'url',\n    },\n    {\n      type: 'url',\n      name: 'secure_url',\n    },\n    {\n      type: 'number',\n      name: 'width',\n    },\n    {\n      type: 'number',\n      name: 'height',\n    },\n    {\n      type: 'number',\n      name: 'bytes',\n    },\n    {\n      type: 'number',\n      name: 'duration',\n      // can be null\n    },\n    {\n      type: 'array',\n      name: 'tags',\n      of: [{type: 'string'}],\n    },\n    {\n      type: 'datetime',\n      name: 'created_at',\n    },\n    {\n      type: 'array',\n      name: 'derived',\n      of: [{type: 'cloudinary.assetDerived'}],\n    },\n    {\n      type: 'string',\n      name: 'access_mode',\n    },\n    {\n      type: 'cloudinary.assetContext',\n      name: 'context',\n    },\n    // metadata array of unknown content\n  ],\n  ...({\n    components: {\n      input: CloudinaryInput,\n      diff: AssetDiff,\n      preview: AssetPreview,\n    },\n  } as {}), //TODO revert this change when rc.1 is released\n  preview: {\n    select: {\n      url: 'url',\n      resource_type: 'resource_type',\n      derived: 'derived.0.url',\n    },\n    prepare({url, derived, resource_type}) {\n      return {\n        title: url,\n        value: {\n          title: url,\n          resource_type,\n          url: derived || url,\n        },\n      }\n    },\n  },\n})\n","import {defineType} from 'sanity'\n\nexport type CloudinaryAssetDerived = {\n  raw_transformation: string\n  url: string\n  secure_url: string\n}\n\nexport const cloudinaryAssetDerivedSchema = defineType({\n  type: 'object',\n  name: 'cloudinary.assetDerived',\n  fields: [\n    {\n      type: 'string',\n      name: 'raw_transformation',\n    },\n    {\n      type: 'url',\n      name: 'url',\n    },\n    {\n      type: 'url',\n      name: 'secure_url',\n    },\n  ],\n})\n","import React from 'react'\n\nexport function CloudinaryIcon() {\n  return (\n    <svg\n      version=\"1.1\"\n      id=\"Layer_1\"\n      x=\"0px\"\n      y=\"0px\"\n      width=\"1em\"\n      height=\"1em\"\n      viewBox=\"0 0 141.732 141.747\"\n      enableBackground=\"new 0 0 141.732 141.747\"\n    >\n      <g>\n        <path\n          fill=\"#0071CE\"\n          d=\"M115.585,109.242c-1.609,0-3.107-1.024-3.635-2.637c-0.657-2.008,0.438-4.169,2.447-4.826\n        c7.278-2.382,11.98-8.761,11.98-16.252c0-9.487-7.718-17.206-17.205-17.206c-0.659,0-1.368,0.052-2.231,0.164l-3.741,0.485\n        l-0.537-3.735c-2.299-16.016-16.251-28.094-32.454-28.094c-13.395,0-25.32,8.019-30.377,20.43l-0.952,2.335l-2.52,0.046\n        c-11.581,0.213-21.003,9.804-21.003,21.379c0,8.45,4.906,16.156,12.498,19.631c1.921,0.88,2.766,3.15,1.886,5.071\n        c-0.88,1.921-3.149,2.764-5.07,1.887C14.363,103.202,7.703,92.766,7.703,81.331c0-14.88,11.465-27.345,26.028-28.876\n        c6.71-14.03,20.773-22.965,36.477-22.965c18.796,0,35.135,13.178,39.372,31.184c13.519,0.219,24.45,11.284,24.45,24.854\n        c0,10.693-6.934,20.146-17.253,23.523C116.382,109.18,115.98,109.242,115.585,109.242z\"\n        />\n        <path\n          fill=\"#DC8327\"\n          d=\"M57.12,111.02c-0.001-0.001-0.001-0.001-0.002-0.001c-0.001,0-0.002-0.001-0.003-0.001h-0.001\n        c0,0-0.001-0.001-0.001-0.001l-0.001-0.001c0,0-0.001,0-0.001-0.001h-0.001l-0.001-0.001c0.001-0.001-0.001-0.001-0.001-0.001\n        l-0.001-0.001c0,0-0.001,0-0.001,0l-0.001-0.001c0.001,0.001-0.001-0.001-0.001-0.001s-0.002-0.001-0.003-0.001l-0.001-0.001H57.1\n        c-0.001-0.001-0.001-0.001-0.001-0.001l-0.001-0.001c-0.003-0.001-0.002-0.001-0.003-0.001c-0.001,0.001-0.001-0.001-0.002-0.001\n        l-0.001-0.001c0,0-0.001-0.001-0.002-0.001l-0.001-0.001c-0.001-0.001-0.003-0.001-0.004-0.001s-0.003-0.001-0.004-0.001\n        c-0.001-0.001-0.001-0.001-0.002-0.001h-0.001c-0.001-0.001-0.002-0.001-0.003-0.001c-0.001-0.001-0.003-0.001-0.003-0.001\n        c-0.001,0-0.001,0-0.001,0l-0.002-0.001c-0.001,0-0.001-0.001-0.001-0.001h-0.001c-0.059-0.021-0.122-0.034-0.188-0.037h-0.002\n        h-0.002c-0.001,0-0.001,0-0.002,0c0,0,0,0-0.001,0c0,0-0.001,0-0.001,0h-0.001c-0.001-0.001-0.001-0.001-0.001-0.001\n        c-0.001,0-0.002,0-0.002,0c-0.001,0-0.002,0-0.002,0h-0.001h-0.001h-0.001c-0.001,0-0.002,0-0.002,0h-0.001H56.86h-0.001h-0.001\n        c-0.001,0-0.001,0-0.001,0h-0.001h-0.001h-0.001h-0.001c-0.001,0-0.001,0-0.001,0c-1.656,0-3.011-1.348-3.021-3V74.29h2.567\n        c0.004,0,0.009,0,0.013,0c0.393,0.017,0.661-0.285,0.661-0.648c0-0.271-0.166-0.503-0.402-0.6l-12.379-8.544\n        c-0.222-0.153-0.515-0.153-0.737,0l-12.476,8.611c-0.234,0.161-0.335,0.456-0.251,0.727c0.085,0.271,0.335,0.455,0.619,0.455h2.58\n        l0.002,33.674c0.013,2.328,1.883,4.228,4.262,4.288c0.027,0.003,0.053,0.005,0.08,0.005h18.481c0.004,0,0.007,0,0.011,0\n        c0.17-0.003,0.324-0.071,0.438-0.18c0,0,0,0,0.001-0.001c0.002-0.002,0.004-0.004,0.005-0.005c0.001-0.001,0.002-0.001,0.003-0.003\n        c0,0,0.001-0.001,0.001-0.001l0.001-0.001l0.001-0.001l0.001-0.001l0.001-0.001c0.001-0.001,0.001-0.001,0.001-0.001\n        c0.002-0.001,0.001-0.001,0.002-0.002c0,0,0,0,0.001-0.001l0.001-0.001c0,0,0,0,0.001-0.001c0.112-0.116,0.182-0.273,0.183-0.447\n        v-0.002v-0.001v-0.001v-0.001v-0.001v-0.001v-0.001v-0.002C57.498,111.345,57.343,111.121,57.12,111.02z\"\n        />\n        <path\n          fill=\"#F4B21B\"\n          d=\"M83.889,111.02c0,0-0.001-0.001-0.002-0.001c-0.001,0-0.002-0.001-0.003-0.001h-0.001\n        c-0.001-0.001-0.001-0.001-0.001-0.001l-0.001-0.001h-0.001c0,0-0.001-0.001-0.001-0.001c0,0-0.001-0.001-0.001-0.001\n        c0.001-0.001-0.001-0.001-0.002-0.001l-0.001-0.001h-0.001c-0.001,0-0.001-0.001-0.001-0.001c-0.002,0.001-0.002-0.001-0.002-0.001\n        l-0.002-0.001l-0.001-0.001h-0.001c0,0-0.001-0.001-0.001-0.001l-0.001-0.001c-0.001-0.001-0.002-0.001-0.002-0.001\n        c-0.001,0.001-0.001-0.001-0.003-0.001l-0.001-0.001l-0.001-0.001c0,0-0.001,0-0.002-0.001c-0.001-0.001-0.003-0.001-0.004-0.001\n        s-0.003-0.001-0.004-0.001c-0.001-0.001-0.001-0.001-0.002-0.001c-0.001,0-0.001,0-0.002-0.001c0,0-0.001,0-0.002-0.001\n        c-0.003-0.001-0.001-0.001-0.002-0.001c-0.003,0-0.001,0-0.002-0.001c0,0-0.001-0.001-0.002-0.001l-0.001-0.001h-0.001\n        c-0.059-0.021-0.122-0.034-0.188-0.037h-0.002c-0.001,0-0.001,0-0.001,0c-0.001,0-0.002,0-0.002,0s-0.001,0-0.001,0h-0.001h-0.001\n        l-0.001-0.001c-0.001,0-0.002,0-0.002,0c-0.001,0-0.002,0-0.002,0h-0.001c-0.001,0-0.001,0-0.001,0h-0.001\n        c-0.001,0-0.002,0-0.002,0s-0.001,0-0.002,0h-0.001c0,0-0.001,0-0.001,0h-0.001c-0.001,0-0.001,0-0.001,0h-0.001h-0.001h-0.001\n        h-0.001c-0.001,0-0.001,0-0.001,0c-1.655,0-3.01-1.348-3.02-3V81.829h2.579c0.009-0.001,0.016-0.001,0.026,0\n        c0.358,0,0.648-0.29,0.648-0.648c0-0.271-0.166-0.503-0.402-0.6l-12.38-8.544c-0.222-0.153-0.515-0.153-0.737,0L57.86,80.647\n        c-0.234,0.161-0.335,0.456-0.251,0.727c0.085,0.271,0.335,0.455,0.619,0.455h2.568l0.002,26.135\n        c0.011,2.329,1.884,4.23,4.264,4.289c0.026,0.003,0.052,0.004,0.078,0.004h18.481c0.004,0,0.007,0,0.011,0\n        c0.17-0.003,0.324-0.071,0.438-0.18c0,0,0,0,0.001-0.001c0.002-0.002,0.006-0.004,0.005-0.005c0.001-0.001,0.002-0.001,0.003-0.003\n        c0.001-0.001,0.001-0.001,0.001-0.001l0.001-0.001l0.001-0.001c0,0,0.001,0,0.001-0.001l0.001-0.001\n        c0.001,0,0.001-0.001,0.001-0.001c0.003-0.001,0.002-0.001,0.002-0.002c0,0,0,0,0.001-0.001c0,0,0,0,0.001-0.001\n        c0,0,0,0,0.001-0.001c0.112-0.116,0.182-0.273,0.183-0.447v-0.002v-0.001v-0.001v-0.001v-0.001v-0.001v-0.001v-0.002\n        C84.267,111.345,84.112,111.121,83.889,111.02z\"\n        />\n        <path\n          fill=\"#F2D864\"\n          d=\"M110.667,111.02l-0.002-0.001c-0.001,0-0.002-0.001-0.003-0.001h-0.001\n        c-0.001-0.001-0.001-0.001-0.001-0.001l-0.001-0.001c-0.001,0-0.001,0-0.001-0.001h-0.001l-0.001-0.001\n        c-0.001-0.001-0.001-0.001-0.001-0.001s-0.001,0-0.001-0.001h-0.001c0,0-0.001-0.001-0.001-0.001\n        c-0.001,0.001-0.001-0.001-0.002-0.001c0.001-0.001-0.001-0.001-0.002-0.001l-0.001-0.001c-0.001,0-0.001,0-0.001,0\n        c-0.001-0.001-0.001-0.001-0.001-0.001l-0.001-0.001c-0.003-0.001-0.002-0.001-0.002-0.001c-0.001,0.001-0.001-0.001-0.003-0.001\n        l-0.001-0.001c0.001-0.001-0.001-0.001-0.002-0.001c0,0-0.001,0-0.001-0.001c-0.001-0.001-0.003-0.001-0.004-0.001\n        s-0.003-0.001-0.004-0.001l-0.002-0.001c0,0-0.001,0-0.002-0.001l-0.002-0.001c-0.003-0.001-0.003-0.001-0.002-0.001\n        c-0.003,0-0.003,0-0.002-0.001c-0.001,0-0.001-0.001-0.001-0.001c-0.001,0-0.002-0.001-0.002-0.001h-0.001\n        c-0.059-0.021-0.122-0.034-0.188-0.037h-0.001c-0.001,0-0.002,0-0.002,0c-0.001,0-0.002,0-0.003,0h-0.001h-0.001h-0.001\n        c-0.001-0.001-0.001-0.001-0.002-0.001c0,0-0.001,0-0.002,0c0,0-0.001,0-0.002,0h-0.001c0,0-0.001,0-0.001,0h-0.001\n        c-0.001,0-0.002,0-0.002,0h-0.002c0,0,0,0-0.001,0c0,0-0.001,0-0.001,0h-0.001c0,0-0.001,0-0.001,0h-0.001h-0.001h-0.001H110.4\n        c0,0-0.001,0-0.001,0c-1.655,0-3.01-1.348-3.02-3V89.365h2.573c0.004,0,0.009,0,0.013,0c0.365-0.009,0.661-0.285,0.661-0.648\n        c0-0.271-0.166-0.503-0.402-0.6l-12.38-8.544c-0.221-0.153-0.515-0.153-0.737,0l-12.476,8.61c-0.234,0.161-0.335,0.456-0.251,0.727\n        c0.085,0.271,0.335,0.455,0.619,0.455h2.573l0.002,18.599c0.013,2.329,1.885,4.231,4.264,4.289\n        c0.026,0.003,0.052,0.004,0.078,0.004h18.481c0.004,0,0.007,0,0.011,0c0.17-0.003,0.324-0.071,0.438-0.18l0.001-0.001\n        c0.002-0.002,0.005-0.004,0.005-0.005c0.001-0.001,0.002-0.001,0.003-0.003c0,0,0.001-0.001,0.001-0.001l0.001-0.001l0.001-0.001\n        l0.001-0.001l0.001-0.001l0.001-0.001c0.003-0.001,0.001-0.001,0.002-0.002c0,0,0,0,0.001-0.001l0.001-0.001c0,0,0,0,0.001-0.001\n        c0.112-0.116,0.182-0.273,0.183-0.447v-0.002v-0.001v-0.001v-0.001v-0.001v-0.001v-0.001v-0.002\n        C111.045,111.345,110.889,111.121,110.667,111.02z\"\n        />\n      </g>\n    </svg>\n  )\n}\n","/* eslint-disable camelcase */\nimport React, {useCallback, useEffect, useRef, useState} from 'react'\nimport {Box, Button, Dialog, Flex, Spinner, Stack, Text} from '@sanity/ui'\nimport {CloudinaryMediaLibrary, InsertHandlerParams} from '../../types'\nimport {createMediaLibrary, decodeSourceId, encodeFilename, encodeSourceId} from '../../utils'\nimport styled from 'styled-components'\nimport {useSecrets} from '@sanity/studio-secrets'\nimport SecretsConfigView, {namespace, Secrets} from '../SecretsConfigView'\nimport {AssetSourceComponentProps, ImageAsset} from 'sanity'\nimport {PlugIcon} from '@sanity/icons'\n\nexport const Widget = styled.div`\n  height: 70vh;\n`\n\nexport function CloudinaryAssetSource(props: AssetSourceComponentProps) {\n  const {onClose} = props\n\n  const [loadingMessage, setLoadingMessage] = useState<string | undefined>(\n    'Loading Cloudinary Media Libary'\n  )\n  const library = useRef<CloudinaryMediaLibrary | undefined>()\n  const contentRef = useRef<HTMLDivElement | null>(null)\n  const {secrets} = useSecrets<Secrets>(namespace)\n  const cloudName = secrets?.cloudName\n  const apiKey = secrets?.apiKey\n  const [widgetId] = useState(() => `cloundinaryWidget-${Date.now()}`)\n  const [showSettings, setShowSettings] = useState(false)\n\n  const propsRef = useRef(props)\n\n  useEffect(() => {\n    // because we have to access props after loading js in a callback,\n    // we cannot pass props as dependecnies as that will cause infinite updates\n    // this takes a snapshot of props, so we can access them later\n    propsRef.current = props\n  }, [props])\n\n  const handleClose = useCallback(() => {\n    if (library.current) {\n      library.current.hide()\n    }\n    onClose()\n  }, [onClose, library])\n\n  useEffect(() => {\n    if (!cloudName || !apiKey) {\n      return\n    }\n\n    createMediaLibrary({\n      cloudName,\n      apiKey,\n      inlineContainer: `#${widgetId}`,\n      libraryCreated: (lib: CloudinaryMediaLibrary) => {\n        library.current = lib\n        const selectedAssets = propsRef.current.selectedAssets\n        const firstSelectedAsset = selectedAssets ? selectedAssets[0] : null\n\n        // eslint-disable-next-line no-undef\n        const iframe: ChildNode | null | undefined =\n          contentRef.current && contentRef.current.firstChild\n        if (iframe && iframe instanceof HTMLIFrameElement) {\n          setLoadingMessage(undefined)\n          let asset\n          if (\n            propsRef.current.selectionType === 'single' &&\n            firstSelectedAsset &&\n            firstSelectedAsset.source &&\n            firstSelectedAsset.source.id\n          ) {\n            asset = decodeSourceId(firstSelectedAsset.source.id)\n          }\n          const folder = asset\n            ? {\n                path: asset.public_id.split('/').slice(0, -1).join('/'),\n                resource_type: 'image',\n              }\n            : {path: '', resource_type: 'image'}\n          if (lib && contentRef.current) {\n            lib.show({folder, asset})\n            contentRef.current.style.visibility = 'visible'\n          }\n        }\n      },\n      insertHandler: ({assets}: InsertHandlerParams) => {\n        if (!library.current) {\n          return\n        }\n        const imageAssets = assets.filter((asset) => asset.resource_type === 'image')\n        if (imageAssets.length === 0) {\n          throw new Error('The selection did not contain any images.')\n        }\n        library.current.hide()\n        propsRef.current.onSelect(\n          imageAssets.map((asset) => {\n            const url =\n              asset.derived && asset.derived[0] ? asset.derived[0].secure_url : asset.secure_url\n            return {\n              kind: 'url',\n              value: url,\n              assetDocumentProps: {\n                _type: 'sanity.imageAsset',\n                originalFilename: encodeFilename(asset),\n                source: {\n                  id: encodeSourceId(asset),\n                  name: `cloudinary:${cloudName}`,\n                },\n              } as ImageAsset,\n            }\n          })\n        )\n      },\n    })\n  }, [cloudName, apiKey, widgetId])\n\n  const hasConfig = apiKey && cloudName\n  return (\n    <Dialog\n      id=\"cloudinary-asset-source\"\n      header=\"Select image from Cloudinary\"\n      onClose={handleClose}\n      open\n      width={4}\n    >\n      <Box padding={4}>\n        {showSettings && <SecretsConfigView onClose={() => setShowSettings(false)} />}\n        <Flex flex={1} justify=\"flex-end\">\n          <Button\n            color=\"primary\"\n            icon={PlugIcon}\n            mode=\"bleed\"\n            title=\"Configure\"\n            onClick={() => setShowSettings(true)}\n            tabIndex={1}\n            text={hasConfig ? undefined : 'Configure Cloudinary plugin'}\n          />\n        </Flex>\n\n        {hasConfig && loadingMessage && (\n          <Stack space={3}>\n            <Flex align=\"center\" justify=\"center\">\n              <Spinner muted />\n            </Flex>\n            <Text size={1} muted align=\"center\">\n              {loadingMessage}\n            </Text>\n          </Stack>\n        )}\n\n        <Widget style={{visibility: 'hidden'}} ref={contentRef} id={widgetId} />\n      </Box>\n    </Dialog>\n  )\n}\n","import {defineType} from 'sanity'\n\nexport interface CloudinaryAssetContext {\n  custom: object\n}\n\nexport const cloudinaryAssetContext = defineType({\n  type: 'object',\n  name: 'cloudinary.assetContext',\n  fields: [\n    {\n      type: 'cloudinary.assetContextCustom',\n      name: 'custom',\n    },\n  ],\n})\n","import {defineType} from 'sanity'\n\nexport type CloudinaryAssetContextCustom = {\n  alt: string\n  caption: string\n}\n\nexport const cloudinaryAssetContextCustom = defineType({\n  type: 'object',\n  name: 'cloudinary.assetContextCustom',\n  fields: [\n    {\n      type: 'string',\n      name: 'alt',\n    },\n    {\n      type: 'string',\n      name: 'caption',\n    },\n  ],\n})\n","import React, {useCallback} from 'react'\nimport {Box, Button, Flex} from '@sanity/ui'\nimport {\n  ArrayInputFunctionsProps,\n  ArrayOfObjectsFunctions,\n  ArraySchemaType,\n  insert,\n  ObjectSchemaType,\n  PatchEvent,\n  setIfMissing,\n} from 'sanity'\n\nimport {useSecrets} from '@sanity/studio-secrets'\nimport SecretsConfigView, {namespace} from './SecretsConfigView'\nimport {cloudinaryAssetSchema} from '../schema/cloudinaryAsset'\nimport {openMediaSelector} from '../utils'\nimport {InsertHandlerParams} from '../types'\nimport {PlugIcon} from '@sanity/icons'\n\ninterface ApiConfig {\n  cloudName: string\n  apiKey: string\n}\n\nexport const AssetListFunctions = (\n  props: ArrayInputFunctionsProps<{_key: string}, ArraySchemaType>\n) => {\n  const {onValueCreate, onChange} = props\n\n  const {secrets, loading} = useSecrets<ApiConfig>(namespace)\n  const [showSettings, setShowSettings] = React.useState(false)\n\n  const show = useCallback(() => setShowSettings(true), [setShowSettings])\n  const hide = useCallback(() => setShowSettings(false), [setShowSettings])\n\n  const cloudinaryType = props.schemaType.of.find(\n    (t: {name: string}) => t.name === cloudinaryAssetSchema.name\n  ) as ObjectSchemaType | undefined\n\n  if (!cloudinaryType) {\n    throw new Error(`AssetListFunctions can only be used in array.of ${\n      cloudinaryAssetSchema.name\n    }, but it was array.of\n    ${props.schemaType.of.map((t) => t.name)}`)\n  }\n\n  const handleSelect = useCallback(\n    (selected: InsertHandlerParams) => {\n      const items = selected.assets.map((asset) =>\n        Object.assign(\n          {},\n          asset,\n          {\n            // Schema version. In case we ever change our schema.\n            _version: 1,\n          },\n          onValueCreate(cloudinaryType as any) // onValueCreate is mistyped\n        )\n      )\n      onChange(PatchEvent.from([setIfMissing([]), insert(items, 'after', [-1])]))\n    },\n    [onValueCreate, onChange, cloudinaryType]\n  )\n\n  const handleOpenSelector = useCallback(\n    () =>\n      secrets &&\n      openMediaSelector(\n        secrets.cloudName,\n        secrets.apiKey,\n        true, // multi-selection\n        handleSelect\n      ),\n    [secrets, handleSelect]\n  )\n  return (\n    <Flex gap={2} flex={1}>\n      {showSettings && <SecretsConfigView onClose={hide} />}\n      <Box flex={1}>\n        <ArrayOfObjectsFunctions {...props} />\n      </Box>\n      {cloudinaryType && (\n        <>\n          <Box flex={1}>\n            <Button\n              style={{width: '100%'}}\n              disabled={props.readOnly || loading}\n              mode=\"bleed\"\n              text=\"Add multiple\"\n              onClick={handleOpenSelector}\n            />\n          </Box>\n          <Box>\n            <Button onClick={show} icon={PlugIcon} mode=\"bleed\" title={'Configure'} />\n          </Box>\n        </>\n      )}\n    </Flex>\n  )\n}\n","import {cloudinaryAssetSchema} from './schema/cloudinaryAsset'\nimport {cloudinaryAssetDerivedSchema} from './schema/cloudinaryAssetDerived'\nimport {\n  definePlugin,\n  AssetSource,\n  ArrayOfObjectsInputProps,\n  isArrayOfObjectsSchemaType,\n} from 'sanity'\nimport {CloudinaryIcon} from './components/asset-source/Icon'\nimport {CloudinaryAssetSource} from './components/asset-source/CloudinaryAssetSource'\nimport {cloudinaryAssetContext} from './schema/cloudinaryAssetContext'\nimport {cloudinaryAssetContextCustom} from './schema/cloudinaryAssetContextCustom'\nimport {AssetListFunctions} from './components/AssetListFunctions'\n\nexport {type CloudinaryAssetContext} from './schema/cloudinaryAssetContext'\nexport {type CloudinaryAssetDerived} from './schema/cloudinaryAssetDerived'\nexport {type CloudinaryAssetContextCustom} from './schema/cloudinaryAssetContextCustom'\n\nexport type {AssetDocument, CloudinaryAsset} from './types'\n\nexport {\n  cloudinaryAssetSchema,\n  cloudinaryAssetDerivedSchema,\n  cloudinaryAssetContext,\n  cloudinaryAssetContextCustom,\n}\n\nexport const cloudinarySchemaPlugin = definePlugin({\n  name: 'cloudinary-schema',\n  form: {\n    components: {\n      input: (props) => {\n        const {schemaType} = props\n        if (isArrayOfObjectsSchemaType(schemaType)) {\n          const arrayProps = props as ArrayOfObjectsInputProps\n          const cloudinaryType = arrayProps.schemaType.of.find(\n            (t: {name: string}) => t.name === cloudinaryAssetSchema.name\n          )\n          if (cloudinaryType) {\n            return arrayProps.renderDefault({...arrayProps, arrayFunctions: AssetListFunctions})\n          }\n        }\n        return props.renderDefault(props)\n      },\n    },\n  },\n  schema: {\n    types: [\n      cloudinaryAssetSchema,\n      cloudinaryAssetDerivedSchema,\n      cloudinaryAssetContext,\n      cloudinaryAssetContextCustom,\n    ],\n  },\n})\n\nexport const cloudinaryImageSource: AssetSource = {\n  name: 'cloudinary-image',\n  title: 'Cloudinary',\n  icon: CloudinaryIcon,\n  component: CloudinaryAssetSource,\n}\n\nexport const cloudinaryAssetSourcePlugin = definePlugin({\n  name: 'cloudinart-asset-source',\n  form: {\n    image: {\n      assetSources: [cloudinaryImageSource],\n    },\n  },\n})\n"],"names":["VideoPlayer","props","src","style","width","height","jsx","controls","children","type","widgetSrc","assetUrl","asset","derived","length","secure_url","url","openMediaSelector","cloudName","apiKey","multiple","insertHandler","selectedAsset","loadJS","options","cloud_name","api_key","insert_caption","public_id","resource_type","window","cloudinary","openMediaLibrary","createMediaLibrary","_ref","inlineContainer","libraryCreated","inline_container","remove_header","callback","existingScript","document","getElementById","script","createElement","id","body","appendChild","onload","encodeSourceId","btoa","JSON","stringify","encodeFilename","concat","split","slice","format","decodeSourceId","sourceId","sourceIdDecoded","parse","atob","err","AssetPreview","_ref2","value","layout","Flex","align","maxWidth","kind","alt","_a","SetupButtonContainer","styled","div","__template","WidgetInput","onChange","readOnly","removeValue","useCallback","PatchEvent","from","unset","Stack","flex","justify","Button","color","icon","PlugIcon","mode","title","onClick","onSetup","tabIndex","textAlign","marginBottom","jsxs","Grid","gap","gridTemplateColumns","disabled","tone","text","pluginConfigKeys","key","description","namespace","SecretsConfigView","SettingsView","keys","onClose","CloudinaryInput","showSettings","setShowSettings","useState","secrets","useSecrets","schemaType","handleSelect","payload","assets","set","Object","assign","_type","name","_version","_key","nanoid","action","Fragment","CloudinaryDiffPreview","_ref3","display","flexWrap","justifyContent","AssetDiff","_ref4","diff","DiffFromTo","previewComponent","cloudinaryAssetSchema","defineType","fields","of","components","input","preview","select","prepare","_ref5","cloudinaryAssetDerivedSchema","CloudinaryIcon","version","x","y","viewBox","enableBackground","fill","d","Widget","CloudinaryAssetSource","loadingMessage","setLoadingMessage","library","useRef","contentRef","widgetId","Date","now","propsRef","useEffect","current","handleClose","hide","lib","selectedAssets","firstSelectedAsset","iframe","firstChild","HTMLIFrameElement","selectionType","source","folder","path","join","show","visibility","_ref6","imageAssets","filter","Error","onSelect","map","assetDocumentProps","originalFilename","hasConfig","Dialog","header","open","Box","padding","space","Spinner","muted","Text","size","ref","cloudinaryAssetContext","cloudinaryAssetContextCustom","AssetListFunctions","onValueCreate","loading","React","cloudinaryType","find","t","selected","items","setIfMissing","insert","handleOpenSelector","ArrayOfObjectsFunctions","cloudinarySchemaPlugin","definePlugin","form","isArrayOfObjectsSchemaType","arrayProps","renderDefault","arrayFunctions","schema","types","cloudinaryImageSource","component","cloudinaryAssetSourcePlugin","image","assetSources"],"mappings":"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"}